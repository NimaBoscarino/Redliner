/* leaflet-measure - v1.2
    Contains fixes by Hatfield Consultants 2015.
*/
(function e(j,c,f){function h(n,p){if(!c[n]){if(!j[n]){var i=typeof require=="function"&&require;if(!p&&i){return i(n,!0)}if(a){return a(n,!0)}var k=new Error("Cannot find module '"+n+"'");throw k.code="MODULE_NOT_FOUND",k}var m=c[n]={exports:{}};j[n][0].call(m.exports,function(l){var o=j[n][1][l];return h(o?o:l)},m,m.exports,e,j,c,f)}return c[n].exports}var a=typeof require=="function"&&require;for(var d=0;d<f.length;d++){h(f[d])}return h})({1:[function(h,f,d){var c=h("color-convert"),i=h("color-string");var a=function(j){if(j instanceof a){return j}if(!(this instanceof a)){return new a(j)}this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1};if(typeof j=="string"){var k=i.getRgba(j);if(k){this.setValues("rgb",k)}else{if(k=i.getHsla(j)){this.setValues("hsl",k)}else{if(k=i.getHwb(j)){this.setValues("hwb",k)}else{throw new Error('Unable to parse color from string "'+j+'"')}}}}else{if(typeof j=="object"){var k=j;if(k.r!==undefined||k.red!==undefined){this.setValues("rgb",k)}else{if(k.l!==undefined||k.lightness!==undefined){this.setValues("hsl",k)}else{if(k.v!==undefined||k.value!==undefined){this.setValues("hsv",k)}else{if(k.w!==undefined||k.whiteness!==undefined){this.setValues("hwb",k)}else{if(k.c!==undefined||k.cyan!==undefined){this.setValues("cmyk",k)}else{throw new Error("Unable to parse color from object "+JSON.stringify(j))}}}}}}}};a.prototype={rgb:function(j){return this.setSpace("rgb",arguments)},hsl:function(j){return this.setSpace("hsl",arguments)},hsv:function(j){return this.setSpace("hsv",arguments)},hwb:function(j){return this.setSpace("hwb",arguments)},cmyk:function(j){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){if(this.values.alpha!==1){return this.values.hwb.concat([this.values.alpha])}return this.values.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var j=this.values.rgb;return j.concat([this.values.alpha])},hslaArray:function(){var j=this.values.hsl;return j.concat([this.values.alpha])},alpha:function(j){if(j===undefined){return this.values.alpha}this.setValues("alpha",j);return this},red:function(j){return this.setChannel("rgb",0,j)},green:function(j){return this.setChannel("rgb",1,j)},blue:function(j){return this.setChannel("rgb",2,j)},hue:function(j){return this.setChannel("hsl",0,j)},saturation:function(j){return this.setChannel("hsl",1,j)},lightness:function(j){return this.setChannel("hsl",2,j)},saturationv:function(j){return this.setChannel("hsv",1,j)},whiteness:function(j){return this.setChannel("hwb",1,j)},blackness:function(j){return this.setChannel("hwb",2,j)},value:function(j){return this.setChannel("hsv",2,j)},cyan:function(j){return this.setChannel("cmyk",0,j)},magenta:function(j){return this.setChannel("cmyk",1,j)},yellow:function(j){return this.setChannel("cmyk",2,j)},black:function(j){return this.setChannel("cmyk",3,j)},hexString:function(){return i.hexString(this.values.rgb)},rgbString:function(){return i.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return i.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return i.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return i.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return i.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return i.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return i.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){return(this.values.rgb[0]<<16)|(this.values.rgb[1]<<8)|this.values.rgb[2]},luminosity:function(){var m=this.values.rgb;var l=[];for(var k=0;k<m.length;k++){var j=m[k]/255;l[k]=(j<=0.03928)?j/12.92:Math.pow(((j+0.055)/1.055),2.4)}return 0.2126*l[0]+0.7152*l[1]+0.0722*l[2]},contrast:function(j){var k=this.luminosity();var l=j.luminosity();if(k>l){return(k+0.05)/(l+0.05)}return(l+0.05)/(k+0.05)},level:function(j){var k=this.contrast(j);return(k>=7.1)?"AAA":(k>=4.5)?"AA":""},dark:function(){var j=this.values.rgb,k=(j[0]*299+j[1]*587+j[2]*114)/1000;return k<128},light:function(){return !this.dark()},negate:function(){var k=[];for(var j=0;j<3;j++){k[j]=255-this.values.rgb[j]}this.setValues("rgb",k);return this},lighten:function(j){this.values.hsl[2]+=this.values.hsl[2]*j;this.setValues("hsl",this.values.hsl);return this},darken:function(j){this.values.hsl[2]-=this.values.hsl[2]*j;this.setValues("hsl",this.values.hsl);return this},saturate:function(j){this.values.hsl[1]+=this.values.hsl[1]*j;this.setValues("hsl",this.values.hsl);return this},desaturate:function(j){this.values.hsl[1]-=this.values.hsl[1]*j;this.setValues("hsl",this.values.hsl);return this},whiten:function(j){this.values.hwb[1]+=this.values.hwb[1]*j;this.setValues("hwb",this.values.hwb);return this},blacken:function(j){this.values.hwb[2]+=this.values.hwb[2]*j;this.setValues("hwb",this.values.hwb);return this},greyscale:function(){var j=this.values.rgb;var k=j[0]*0.3+j[1]*0.59+j[2]*0.11;this.setValues("rgb",[k,k,k]);return this},clearer:function(j){this.setValues("alpha",this.values.alpha-(this.values.alpha*j));return this},opaquer:function(j){this.setValues("alpha",this.values.alpha+(this.values.alpha*j));return this},rotate:function(j){var k=this.values.hsl[0];k=(k+j)%360;k=k<0?360+k:k;this.values.hsl[0]=k;this.setValues("hsl",this.values.hsl);return this},mix:function(k,q){q=1-(q==null?0.5:q);var p=q*2-1,l=this.alpha()-k.alpha();var s=(((p*l==-1)?p:(p+l)/(1+p*l))+1)/2;var t=1-s;var n=this.rgbArray();var o=k.rgbArray();for(var m=0;m<n.length;m++){n[m]=n[m]*s+o[m]*t}this.setValues("rgb",n);var j=this.alpha()*q+k.alpha()*(1-q);this.setValues("alpha",j);return this},toJSON:function(){return this.rgb()},clone:function(){return new a(this.rgb())}};a.prototype.getValues=function(k){var l={};for(var j=0;j<k.length;j++){l[k.charAt(j)]=this.values[k][j]}if(this.values.alpha!=1){l.a=this.values.alpha}return l};a.prototype.setValues=function(p,s){var q={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]};var n={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]};var j=1;if(p=="alpha"){j=s}else{if(s.length){this.values[p]=s.slice(0,p.length);j=s[p.length]}else{if(s[p.charAt(0)]!==undefined){for(var m=0;m<p.length;m++){this.values[p][m]=s[p.charAt(m)]}j=s.a}else{if(s[q[p][0]]!==undefined){var l=q[p];for(var m=0;m<p.length;m++){this.values[p][m]=s[l[m]]}j=s.alpha}}}}this.values.alpha=Math.max(0,Math.min(1,(j!==undefined?j:this.values.alpha)));if(p=="alpha"){return}for(var m=0;m<p.length;m++){var k=Math.max(0,Math.min(n[p][m],this.values[p][m]));this.values[p][m]=Math.round(k)}for(var o in q){if(o!=p){this.values[o]=c[p][o](this.values[p])}for(var m=0;m<o.length;m++){var k=Math.max(0,Math.min(n[o][m],this.values[o][m]));this.values[o][m]=Math.round(k)}}return true};a.prototype.setSpace=function(k,j){var l=j[0];if(l===undefined){return this.getValues(k)}if(typeof l=="number"){l=Array.prototype.slice.call(j)}this.setValues(k,l);return this};a.prototype.setChannel=function(k,j,l){if(l===undefined){return this.values[k][j]}this.values[k][j]=l;this.setValues(k,this.values[k]);return this};f.exports=a},{"color-convert":3,"color-string":4}],2:[function(P,O,j){O.exports={rgb2hsl:S,rgb2hsv:T,rgb2hwb:U,rgb2cmyk:R,rgb2keyword:V,rgb2xyz:Y,rgb2lab:W,rgb2lch:X,hsl2rgb:o,hsl2hsv:l,hsl2hwb:m,hsl2cmyk:k,hsl2keyword:n,hsv2rgb:u,hsv2hsl:q,hsv2hwb:s,hsv2cmyk:p,hsv2keyword:t,hwb2rgb:z,hwb2hsl:w,hwb2hsv:x,hwb2cmyk:v,hwb2keyword:y,cmyk2rgb:h,cmyk2hsl:a,cmyk2hsv:c,cmyk2hwb:d,cmyk2keyword:f,keyword2rgb:G,keyword2hsl:C,keyword2hsv:D,keyword2hwb:E,keyword2cmyk:B,keyword2lab:F,keyword2xyz:H,xyz2rgb:ab,xyz2lab:Z,xyz2lch:aa,lab2xyz:K,lab2rgb:J,lab2lch:I,lch2lab:L,lch2xyz:N,lch2rgb:M};function S(ak){var aj=ak[0]/255,ae=ak[1]/255,ac=ak[2]/255,ai=Math.min(aj,ae,ac),ah=Math.max(aj,ae,ac),ad=ah-ai,af,al,ag;if(ah==ai){af=0}else{if(aj==ah){af=(ae-ac)/ad}else{if(ae==ah){af=2+(ac-aj)/ad}else{if(ac==ah){af=4+(aj-ae)/ad}}}}af=Math.min(af*60,360);if(af<0){af+=360}ag=(ai+ah)/2;if(ah==ai){al=0}else{if(ag<=0.5){al=ad/(ah+ai)}else{al=ad/(2-ah-ai)}}return[af,al*100,ag*100]}function T(aj){var ai=aj[0],ae=aj[1],ac=aj[2],ah=Math.min(ai,ae,ac),ag=Math.max(ai,ae,ac),ad=ag-ah,af,ak,al;if(ag==0){ak=0}else{ak=(ad/ag*1000)/10}if(ag==ah){af=0}else{if(ai==ag){af=(ae-ac)/ad}else{if(ae==ag){af=2+(ac-ai)/ad}else{if(ac==ag){af=4+(ai-ae)/ad}}}}af=Math.min(af*60,360);if(af<0){af+=360}al=((ag/255)*1000)/10;return[af,ak,al]}function U(ag){var af=ag[0],ad=ag[1],ac=ag[2],ae=S(ag)[0],ah=1/255*Math.min(af,Math.min(ad,ac)),ac=1-1/255*Math.max(af,Math.max(ad,ac));return[ae,ah*100,ac*100]}function R(ai){var ah=ai[0]/255,ae=ai[1]/255,ac=ai[2]/255,ad,ag,aj,af;af=Math.min(1-ah,1-ae,1-ac);ad=(1-ah-af)/(1-af)||0;ag=(1-ae-af)/(1-af)||0;aj=(1-ac-af)/(1-af)||0;return[ad*100,ag*100,aj*100,af*100]}function V(ac){return Q[JSON.stringify(ac)]}function Y(af){var ae=af[0]/255,ad=af[1]/255,ac=af[2]/255;ae=ae>0.04045?Math.pow(((ae+0.055)/1.055),2.4):(ae/12.92);ad=ad>0.04045?Math.pow(((ad+0.055)/1.055),2.4):(ad/12.92);ac=ac>0.04045?Math.pow(((ac+0.055)/1.055),2.4):(ac/12.92);var ag=(ae*0.4124)+(ad*0.3576)+(ac*0.1805);var ah=(ae*0.2126)+(ad*0.7152)+(ac*0.0722);var ai=(ae*0.0193)+(ad*0.1192)+(ac*0.9505);return[ag*100,ah*100,ai*100]}function W(af){var ah=Y(af),ag=ah[0],ai=ah[1],aj=ah[2],ae,ac,ad;ag/=95.047;ai/=100;aj/=108.883;ag=ag>0.008855999999999999?Math.pow(ag,1/3):(7.787*ag)+(16/116);ai=ai>0.008855999999999999?Math.pow(ai,1/3):(7.787*ai)+(16/116);aj=aj>0.008855999999999999?Math.pow(aj,1/3):(7.787*aj)+(16/116);ae=(116*ai)-16;ac=500*(ag-ai);ad=200*(ai-aj);return[ae,ac,ad]}function X(ac){return I(W(ac))}function o(ad){var ac=ad[0]/360,ah=ad[1]/100,af=ad[2]/100,ai,aj,ak,ag,al;if(ah==0){al=af*255;return[al,al,al]}if(af<0.5){aj=af*(1+ah)}else{aj=af+ah-af*ah}ai=2*af-aj;ag=[0,0,0];for(var ae=0;ae<3;ae++){ak=ac+1/3*-(ae-1);ak<0&&ak++;ak>1&&ak--;if(6*ak<1){al=ai+(aj-ai)*6*ak}else{if(2*ak<1){al=aj}else{if(3*ak<2){al=ai+(aj-ai)*(2/3-ak)*6}else{al=ai}}}ag[ae]=al*255}return ag}function l(ad){var ac=ad[0],af=ad[1]/100,ae=ad[2]/100,ag,ah;ae*=2;af*=(ae<=1)?ae:2-ae;ah=(ae+af)/2;ag=(2*af)/(ae+af);return[ac,ag*100,ah*100]}function m(ac){return U(o(ac))}function k(ac){return R(o(ac))}function n(ac){return V(o(ac))}function u(af){var ad=af[0]/60,ai=af[1]/100,ak=af[2]/100,ae=Math.floor(ad)%6;var ac=ad-Math.floor(ad),ag=255*ak*(1-ai),ah=255*ak*(1-(ai*ac)),aj=255*ak*(1-(ai*(1-ac))),ak=255*ak;switch(ae){case 0:return[ak,aj,ag];case 1:return[ah,ak,ag];case 2:return[ag,ak,aj];case 3:return[ag,ah,ak];case 4:return[aj,ag,ak];case 5:return[ak,ag,ah]}}function q(ad){var ac=ad[0],af=ad[1]/100,ah=ad[2]/100,ag,ae;ae=(2-af)*ah;ag=af*ah;ag/=(ae<=1)?ae:2-ae;ag=ag||0;ae/=2;return[ac,ag*100,ae*100]}function s(ac){return U(u(ac))}function p(ac){return R(u(ac))}function t(ac){return V(u(ac))}function z(af){var ae=af[0]/360,ak=af[1]/100,ac=af[2]/100,ai=ak+ac,ag,aj,ad,ah;if(ai>1){ak/=ai;ac/=ai}ag=Math.floor(6*ae);aj=1-ac;ad=6*ae-ag;if((ag&1)!=0){ad=1-ad}ah=ak+ad*(aj-ak);switch(ag){default:case 6:case 0:r=aj;g=ah;b=ak;break;case 1:r=ah;g=aj;b=ak;break;case 2:r=ak;g=aj;b=ah;break;case 3:r=ak;g=ah;b=aj;break;case 4:r=ah;g=ak;b=aj;break;case 5:r=aj;g=ak;b=ah;break}return[r*255,g*255,b*255]}function w(ac){return S(z(ac))}function x(ac){return T(z(ac))}function v(ac){return R(z(ac))}function y(ac){return V(z(ac))}function h(ae){var ad=ae[0]/100,ah=ae[1]/100,aj=ae[2]/100,ag=ae[3]/100,ai,af,ac;ai=1-Math.min(1,ad*(1-ag)+ag);af=1-Math.min(1,ah*(1-ag)+ag);ac=1-Math.min(1,aj*(1-ag)+ag);return[ai*255,af*255,ac*255]}function a(ac){return S(h(ac))}function c(ac){return T(h(ac))}function d(ac){return U(h(ac))}function f(ac){return V(h(ac))}function ab(ag){var af=ag[0]/100,ah=ag[1]/100,ai=ag[2]/100,ae,ad,ac;ae=(af*3.2406)+(ah*-1.5372)+(ai*-0.4986);ad=(af*-0.9689)+(ah*1.8758)+(ai*0.0415);ac=(af*0.0557)+(ah*-0.204)+(ai*1.057);ae=ae>0.0031308?((1.055*Math.pow(ae,1/2.4))-0.055):ae=(ae*12.92);ad=ad>0.0031308?((1.055*Math.pow(ad,1/2.4))-0.055):ad=(ad*12.92);ac=ac>0.0031308?((1.055*Math.pow(ac,1/2.4))-0.055):ac=(ac*12.92);ae=Math.min(Math.max(0,ae),1);ad=Math.min(Math.max(0,ad),1);ac=Math.min(Math.max(0,ac),1);return[ae*255,ad*255,ac*255]}function Z(ag){var af=ag[0],ah=ag[1],ai=ag[2],ae,ac,ad;af/=95.047;ah/=100;ai/=108.883;af=af>0.008855999999999999?Math.pow(af,1/3):(7.787*af)+(16/116);ah=ah>0.008855999999999999?Math.pow(ah,1/3):(7.787*ah)+(16/116);ai=ai>0.008855999999999999?Math.pow(ai,1/3):(7.787*ai)+(16/116);ae=(116*ah)-16;ac=500*(af-ah);ad=200*(ah-ai);return[ae,ac,ad]}function aa(ac){return I(Z(ac))}function K(af){var ae=af[0],ac=af[1],ad=af[2],ag,ah,aj,ai;if(ae<=8){ah=(ae*100)/903.3;ai=(7.787*(ah/100))+(16/116)}else{ah=100*Math.pow((ae+16)/116,3);ai=Math.pow(ah/100,1/3)}ag=ag/95.047<=0.008855999999999999?ag=(95.047*((ac/500)+ai-(16/116)))/7.787:95.047*Math.pow((ac/500)+ai,3);aj=aj/108.883<=0.008859000000000001?aj=(108.883*(ai-(ad/200)-(16/116)))/7.787:108.883*Math.pow(ai-(ad/200),3);return[ag,ah,aj]}function I(ai){var ah=ai[0],ac=ai[1],ad=ai[2],ag,af,ae;ag=Math.atan2(ad,ac);af=ag*360/2/Math.PI;if(af<0){af+=360}ae=Math.sqrt(ac*ac+ad*ad);return[ah,ae,af]}function J(ac){return ab(K(ac))}function L(ai){var ah=ai[0],ae=ai[1],af=ai[2],ac,ad,ag;ag=af/360*2*Math.PI;ac=ae*Math.cos(ag);ad=ae*Math.sin(ag);return[ah,ac,ad]}function N(ac){return K(L(ac))}function M(ac){return J(L(ac))}function G(ac){return i[ac]}function C(ac){return S(G(ac))}function D(ac){return T(G(ac))}function E(ac){return U(G(ac))}function B(ac){return R(G(ac))}function F(ac){return W(G(ac))}function H(ac){return Y(G(ac))}var i={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var Q={};for(var A in i){Q[JSON.stringify(i[A])]=A}},{}],3:[function(l,j,f){var a=l("./conversions");var c=function(){return new d()};for(var i in a){c[i+"Raw"]=(function(n){return function(o){if(typeof o=="number"){o=Array.prototype.slice.call(arguments)}return a[n](o)}})(i);var k=/(\w+)2(\w+)/.exec(i),h=k[1],m=k[2];c[h]=c[h]||{};c[h][m]=c[i]=(function(n){return function(o){if(typeof o=="number"){o=Array.prototype.slice.call(arguments)}var q=a[n](o);if(typeof q=="string"||q===undefined){return q}for(var p=0;p<q.length;p++){q[p]=Math.round(q[p])}return q}})(i)}var d=function(){this.convs={}};d.prototype.routeSpace=function(o,n){var p=n[0];if(p===undefined){return this.getValues(o)}if(typeof p=="number"){p=Array.prototype.slice.call(n)}return this.setValues(o,p)};d.prototype.setValues=function(n,o){this.space=n;this.convs={};this.convs[n]=o;return this};d.prototype.getValues=function(p){var q=this.convs[p];if(!q){var o=this.space,n=this.convs[o];q=c[o][p](n);this.convs[p]=q}return q};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(n){d.prototype[n]=function(o){return this.routeSpace(n,arguments)}});j.exports=c},{"./conversions":2}],4:[function(w,s,c){var a=w("color-name");s.exports={getRgba:k,getHsla:h,getRgb:j,getHsl:f,getHwb:i,getAlpha:d,hexString:m,rgbString:z,rgbaString:y,percentString:v,percentaString:u,hslString:o,hslaString:n,hwbString:p,keyword:q};function k(K){if(!K){return}var C=/^#([a-fA-F0-9]{3})$/,D=/^#([a-fA-F0-9]{6})$/,J=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,H=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,F=/(\D+)/;var I=[0,0,0],B=1,G=K.match(C);if(G){G=G[1];for(var E=0;E<I.length;E++){I[E]=parseInt(G[E]+G[E],16)}}else{if(G=K.match(D)){G=G[1];for(var E=0;E<I.length;E++){I[E]=parseInt(G.slice(E*2,E*2+2),16)}}else{if(G=K.match(J)){for(var E=0;E<I.length;E++){I[E]=parseInt(G[E+1])}B=parseFloat(G[4])}else{if(G=K.match(H)){for(var E=0;E<I.length;E++){I[E]=Math.round(parseFloat(G[E+1])*2.55)}B=parseFloat(G[4])}else{if(G=K.match(F)){if(G[1]=="transparent"){return[0,0,0,0]}I=a[G[1]];if(!I){return}}}}}}for(var E=0;E<I.length;E++){I[E]=A(I[E],0,255)}if(!B&&B!=0){B=1}else{B=A(B,0,1)}I[3]=B;return I}function h(I){if(!I){return}var E=/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/;var G=I.match(E);if(G){var C=parseFloat(G[4]);var D=A(parseInt(G[1]),0,360),H=A(parseFloat(G[2]),0,100),F=A(parseFloat(G[3]),0,100),B=A(isNaN(C)?1:C,0,1);return[D,H,F,B]}}function i(H){if(!H){return}var F=/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/;var G=H.match(F);if(G){var C=parseFloat(G[4]);var E=A(parseInt(G[1]),0,360),I=A(parseFloat(G[2]),0,100),D=A(parseFloat(G[3]),0,100),B=A(isNaN(C)?1:C,0,1);return[E,I,D,B]}}function j(C){var B=k(C);return B&&B.slice(0,3)}function f(C){var B=h(C);return B&&B.slice(0,3)}function d(B){var C=k(B);if(C){return C[3]}else{if(C=h(B)){return C[3]}else{if(C=i(B)){return C[3]}}}}function m(B){return"#"+l(B[0])+l(B[1])+l(B[2])}function z(C,B){if(B<1||(C[3]&&C[3]<1)){return y(C,B)}return"rgb("+C[0]+", "+C[1]+", "+C[2]+")"}function y(C,B){if(B===undefined){B=(C[3]!==undefined?C[3]:1)}return"rgba("+C[0]+", "+C[1]+", "+C[2]+", "+B+")"}function v(F,B){if(B<1||(F[3]&&F[3]<1)){return u(F,B)}var E=Math.round(F[0]/255*100),D=Math.round(F[1]/255*100),C=Math.round(F[2]/255*100);return"rgb("+E+"%, "+D+"%, "+C+"%)"}function u(F,B){var E=Math.round(F[0]/255*100),D=Math.round(F[1]/255*100),C=Math.round(F[2]/255*100);return"rgba("+E+"%, "+D+"%, "+C+"%, "+(B||F[3]||1)+")"}function o(C,B){if(B<1||(C[3]&&C[3]<1)){return n(C,B)}return"hsl("+C[0]+", "+C[1]+"%, "+C[2]+"%)"}function n(C,B){if(B===undefined){B=(C[3]!==undefined?C[3]:1)}return"hsla("+C[0]+", "+C[1]+"%, "+C[2]+"%, "+B+")"}function p(C,B){if(B===undefined){B=(C[3]!==undefined?C[3]:1)}return"hwb("+C[0]+", "+C[1]+"%, "+C[2]+"%"+(B!==undefined&&B!==1?", "+B:"")+")"}function q(B){return x[B.slice(0,3)]}function A(D,C,B){return Math.min(Math.max(C,D),B)}function l(B){var C=B.toString(16).toUpperCase();return(C.length<2)?"0"+C:C}var x={};for(var t in a){x[a[t]]=t}},{"color-name":5}],5:[function(d,c,a){c.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],6:[function(d,c,a){c.exports=d("./lib/geocrunch")},{"./lib/geocrunch":11}],7:[function(l,j,h){var a=l("underscore");var k=l("./constants").EARTHRADIUS;var m=l("./units");var i=l("./flipcoords");var f={sqmeters:function(n){return n},sqmiles:function(n){return m.sqMeters.toSqMiles(n)},acres:function(n){return m.sqMeters.toAcres(n)}};var c=function(q){var n=0,s,t,o,p;for(s=0,t=q.length;s<t;s+=1){o=q[s];p=q[(s+1)%q.length];n=n+m.degrees.toRadians(p[0]-o[0])*(2+Math.sin(m.degrees.toRadians(o[1]))+Math.sin(m.degrees.toRadians(p[1])))}return Math.abs(n*k*k/2)};var d=function(p){var u=p[0],v=0,w=0,z=0,s,t,n,o,q;if(p.length===1){return p[0]}for(s=0,t=p.length;s<t;s+=1){n=p[s];o=p[(s+1)%p.length];q=(n[1]-u[1])*(o[0]-u[0])-(o[1]-u[1])*(n[0]-u[0]);v=v+q;w=w+((n[0]+o[0]-2*u[0])*q);z=z+((n[1]+o[1]-2*u[1])*q)}q=v*3;return[w/q+u[0],z/q+u[1]]};j.exports={_internalAreaCalc:function(){if(!this._calcedArea){if(this._coords.length<3){this._calcedArea=0}else{this._calcedArea=c(this._coords)}}},_internalCenterCalc:function(){if(!this._calcedCenter&&this._coords.length){this._calcedCenter=d(this._coords)}},area:function(n){var o=a.extend({units:"sqmeters"},n);this._internalAreaCalc();if(a.isFunction(f[o.units])){return f[o.units](this._calcedArea)}},center:function(){this._internalCenterCalc();return this._options.imBackwards===true?i(this._calcedCenter):this._calcedCenter}}},{"./constants":8,"./flipcoords":10,"./units":13,underscore:14}],8:[function(d,c,a){c.exports={EARTHRADIUS:6371000}},{}],9:[function(j,h,f){var a=j("underscore");var i=j("./constants").EARTHRADIUS;var k=j("./units");var d={meters:function(l){return l},kilometers:function(l){return k.meters.toKilometers(l)},feet:function(l){return k.meters.toFeet(l)},miles:function(l){return k.meters.toMiles(l)}};var c=function(m,n){var p=k.degrees.toRadians(m[0]-n[0]),o=k.degrees.toRadians(m[1]-n[1]),t=k.degrees.toRadians(m[1]),u=k.degrees.toRadians(n[1]),s=Math.sin(p/2),q=Math.sin(o/2);var l=q*q+s*s*Math.cos(t)*Math.cos(u);return i*2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))};h.exports={_internalDistanceCalc:function(){var m=0,n,o;if(!this._calcedDistance){for(n=0,o=this._coords.length;n<o;n+=1){if(n>0){m=m+c(this._coords[n-1],this._coords[n])}}this._calcedDistance=m}},distance:function(l){var m=a.extend({units:"meters"},l);this._internalDistanceCalc();if(a.isFunction(d[m.units])){return d[m.units](this._calcedDistance)}}}},{"./constants":8,"./units":13,underscore:14}],10:[function(f,d,c){var a=f("underscore");d.exports=function(h){return a.map(h,function(i){return[i[1],i[0]]})}},{underscore:14}],11:[function(j,h,f){var a=j("underscore");var i=j("./path");var d=j("./distance"),c=j("./area");a.extend(i.prototype,d,c);f.path=function(k,l){return new i(k,l)}},{"./area":7,"./distance":9,"./path":12,underscore:14}],12:[function(h,d,a){var c=h("./flipcoords");var f=function(i,j){this._options=j||{};i=i||[];this._coords=this._options.imBackwards===true?c(i):i};d.exports=f},{"./flipcoords":10}],13:[function(d,c,a){a.meters={toFeet:function(f){return f*3.28084},toKilometers:function(f){return f*0.001},toMiles:function(f){return f*0.000621371}};a.sqMeters={toSqMiles:function(f){return f*3.86102e-07},toAcres:function(f){return f*0.000247105}};a.degrees={toRadians:function(f){return f*Math.PI/180}}},{}],14:[function(d,c,a){(function(){var R=this;var N=R._;var j={};var i=Array.prototype,M=Object.prototype,u=Function.prototype;var O=i.push,S=i.slice,k=i.concat,T=M.toString,w=M.hasOwnProperty;var C=i.forEach,H=i.map,I=i.reduce,J=i.reduceRight,B=i.filter,A=i.every,K=i.some,D=i.indexOf,G=i.lastIndexOf,E=Array.isArray,F=Object.keys,z=u.bind;var f=function(U){if(U instanceof f){return U}if(!(this instanceof f)){return new f(U)}this._wrapped=U};if(typeof a!=="undefined"){if(typeof c!=="undefined"&&c.exports){a=c.exports=f}a._=f}else{R._=f}f.VERSION="1.5.2";var m=f.each=f.forEach=function(Z,W,U){if(Z==null){return}if(C&&Z.forEach===C){Z.forEach(W,U)}else{if(Z.length===+Z.length){for(var V=0,Y=Z.length;V<Y;V++){if(W.call(U,Z[V],V,Z)===j){return}}}else{var X=f.keys(Z);for(var V=0,Y=X.length;V<Y;V++){if(W.call(U,Z[X[V]],X[V],Z)===j){return}}}}};f.map=f.collect=function(W,V,U){var X=[];if(W==null){return X}if(H&&W.map===H){return W.map(V,U)}m(W,function(aa,Y,Z){X.push(V.call(U,aa,Y,Z))});return X};var P="Reduce of empty array with no initial value";f.reduce=f.foldl=f.inject=function(Y,W,X,U){var V=arguments.length>2;if(Y==null){Y=[]}if(I&&Y.reduce===I){if(U){W=f.bind(W,U)}return V?Y.reduce(W,X):Y.reduce(W)}m(Y,function(ab,Z,aa){if(!V){X=ab;V=true}else{X=W.call(U,X,ab,Z,aa)}});if(!V){throw new TypeError(P)}return X};f.reduceRight=f.foldr=function(aa,W,Z,U){var V=arguments.length>2;if(aa==null){aa=[]}if(J&&aa.reduceRight===J){if(U){W=f.bind(W,U)}return V?aa.reduceRight(W,Z):aa.reduceRight(W)}var Y=aa.length;if(Y!==+Y){var X=f.keys(aa);Y=X.length}m(aa,function(ad,ab,ac){ab=X?X[--Y]:--Y;if(!V){Z=aa[ab];V=true}else{Z=W.call(U,Z,aa[ab],ab,ac)}});if(!V){throw new TypeError(P)}return Z};f.find=f.detect=function(W,V,U){var X;h(W,function(aa,Y,Z){if(V.call(U,aa,Y,Z)){X=aa;return true}});return X};f.filter=f.select=function(W,V,U){var X=[];if(W==null){return X}if(B&&W.filter===B){return W.filter(V,U)}m(W,function(aa,Y,Z){if(V.call(U,aa,Y,Z)){X.push(aa)}});return X};f.reject=function(W,V,U){return f.filter(W,function(Z,X,Y){return !V.call(U,Z,X,Y)},U)};f.every=f.all=function(W,V,U){V||(V=f.identity);var X=true;if(W==null){return X}if(A&&W.every===A){return W.every(V,U)}m(W,function(aa,Y,Z){if(!(X=X&&V.call(U,aa,Y,Z))){return j}});return !!X};var h=f.some=f.any=function(W,V,U){V||(V=f.identity);var X=false;if(W==null){return X}if(K&&W.some===K){return W.some(V,U)}m(W,function(aa,Y,Z){if(X||(X=V.call(U,aa,Y,Z))){return j}});return !!X};f.contains=f.include=function(U,V){if(U==null){return false}if(D&&U.indexOf===D){return U.indexOf(V)!=-1}return h(U,function(W){return W===V})};f.invoke=function(X,W){var U=S.call(arguments,2);var V=f.isFunction(W);return f.map(X,function(Y){return(V?W:Y[W]).apply(Y,U)})};f.pluck=function(V,U){return f.map(V,function(W){return W[U]})};f.where=function(W,U,V){if(f.isEmpty(U)){return V?void 0:[]}return f[V?"find":"filter"](W,function(Y){for(var X in U){if(U[X]!==Y[X]){return false}}return true})};f.findWhere=function(V,U){return f.where(V,U,true)};f.max=function(W,V,U){if(!V&&f.isArray(W)&&W[0]===+W[0]&&W.length<65535){return Math.max.apply(Math,W)}if(!V&&f.isEmpty(W)){return -Infinity}var X={computed:-Infinity,value:-Infinity};m(W,function(ab,Z,aa){var Y=V?V.call(U,ab,Z,aa):ab;Y>X.computed&&(X={value:ab,computed:Y})});return X.value};f.min=function(W,V,U){if(!V&&f.isArray(W)&&W[0]===+W[0]&&W.length<65535){return Math.min.apply(Math,W)}if(!V&&f.isEmpty(W)){return Infinity}var X={computed:Infinity,value:Infinity};m(W,function(ab,Z,aa){var Y=V?V.call(U,ab,Z,aa):ab;Y<X.computed&&(X={value:ab,computed:Y})});return X.value};f.shuffle=function(V){var W;var U=0;var X=[];m(V,function(Y){W=f.random(U++);X[U-1]=X[W];X[W]=Y});return X};f.sample=function(W,V,U){if(arguments.length<2||U){return W[f.random(W.length-1)]}return f.shuffle(W).slice(0,Math.max(0,V))};var y=function(U){return f.isFunction(U)?U:function(V){return V[U]}};f.sortBy=function(W,X,U){var V=y(X);return f.pluck(f.map(W,function(aa,Y,Z){return{value:aa,index:Y,criteria:V.call(U,aa,Y,Z)}}).sort(function(aa,ab){var Y=aa.criteria;var Z=ab.criteria;if(Y!==Z){if(Y>Z||Y===void 0){return 1}if(Y<Z||Z===void 0){return -1}}return aa.index-ab.index}),"value")};var v=function(U){return function(X,Z,V){var Y={};var W=Z==null?f.identity:y(Z);m(X,function(ac,aa){var ab=W.call(V,ac,aa,X);U(Y,ab,ac)});return Y}};f.groupBy=v(function(V,U,W){(f.has(V,U)?V[U]:(V[U]=[])).push(W)});f.indexBy=v(function(V,U,W){V[U]=W});f.countBy=v(function(V,U){f.has(V,U)?V[U]++:V[U]=1});f.sortedIndex=function(U,aa,X,V){X=X==null?f.identity:y(X);var ab=X.call(V,aa);var Y=0,W=U.length;while(Y<W){var Z=(Y+W)>>>1;X.call(V,U[Z])<ab?Y=Z+1:W=Z}return Y};f.toArray=function(U){if(!U){return[]}if(f.isArray(U)){return S.call(U)}if(U.length===+U.length){return f.map(U,f.identity)}return f.values(U)};f.size=function(U){if(U==null){return 0}return(U.length===+U.length)?U.length:f.keys(U).length};f.first=f.head=f.take=function(U,W,V){if(U==null){return void 0}return(W==null)||V?U[0]:S.call(U,0,W)};f.initial=function(U,W,V){return S.call(U,0,U.length-((W==null)||V?1:W))};f.last=function(U,W,V){if(U==null){return void 0}if((W==null)||V){return U[U.length-1]}else{return S.call(U,Math.max(U.length-W,0))}};f.rest=f.tail=f.drop=function(U,W,V){return S.call(U,(W==null)||V?1:W)};f.compact=function(U){return f.filter(U,f.identity)};var t=function(U,W,V){if(W&&f.every(U,f.isArray)){return k.apply(V,U)}m(U,function(X){if(f.isArray(X)||f.isArguments(X)){W?O.apply(V,X):t(X,W,V)}else{V.push(X)}});return V};f.flatten=function(U,V){return t(U,V,[])};f.without=function(U){return f.difference(U,S.call(arguments,1))};f.uniq=f.unique=function(U,X,Y,V){if(f.isFunction(X)){V=Y;Y=X;X=false}var W=Y?f.map(U,Y,V):U;var Z=[];var aa=[];m(W,function(ac,ab){if(X?(!ab||aa[aa.length-1]!==ac):!f.contains(aa,ac)){aa.push(ac);Z.push(U[ab])}});return Z};f.union=function(){return f.uniq(f.flatten(arguments,true))};f.intersection=function(U){var V=S.call(arguments,1);return f.filter(f.uniq(U),function(W){return f.every(V,function(X){return f.indexOf(X,W)>=0})})};f.difference=function(U){var V=k.apply(i,S.call(arguments,1));return f.filter(U,function(W){return !f.contains(V,W)})};f.zip=function(){var V=f.max(f.pluck(arguments,"length").concat(0));var W=new Array(V);for(var U=0;U<V;U++){W[U]=f.pluck(arguments,""+U)}return W};f.object=function(W,Y){if(W==null){return{}}var X={};for(var U=0,V=W.length;U<V;U++){if(Y){X[W[U]]=Y[U]}else{X[W[U][0]]=W[U][1]}}return X};f.indexOf=function(U,X,W){if(U==null){return -1}var V=0,Y=U.length;if(W){if(typeof W=="number"){V=(W<0?Math.max(0,Y+W):W)}else{V=f.sortedIndex(U,X);return U[V]===X?V:-1}}if(D&&U.indexOf===D){return U.indexOf(X,W)}for(;V<Y;V++){if(U[V]===X){return V}}return -1};f.lastIndexOf=function(U,Y,V){if(U==null){return -1}var W=V!=null;if(G&&U.lastIndexOf===G){return W?U.lastIndexOf(Y,V):U.lastIndexOf(Y)}var X=(W?V:U.length);while(X--){if(U[X]===Y){return X}}return -1};f.range=function(X,Z,Y){if(arguments.length<=1){Z=X||0;X=0}Y=arguments[2]||1;var V=Math.max(Math.ceil((Z-X)/Y),0);var U=0;var W=new Array(V);while(U<V){W[U++]=X;X+=Y}return W};var l=function(){};f.bind=function(X,W){var U,V;if(z&&X.bind===z){return z.apply(X,S.call(arguments,1))}if(!f.isFunction(X)){throw new TypeError}U=S.call(arguments,2);return V=function(){if(!(this instanceof V)){return X.apply(W,U.concat(S.call(arguments)))}l.prototype=X.prototype;var Z=new l;l.prototype=null;var Y=X.apply(Z,U.concat(S.call(arguments)));if(Object(Y)===Y){return Y}return Z}};f.partial=function(V){var U=S.call(arguments,1);return function(){return V.apply(this,U.concat(S.call(arguments)))}};f.bindAll=function(V){var U=S.call(arguments,1);if(U.length===0){throw new Error("bindAll must be passed function names")}m(U,function(W){V[W]=f.bind(V[W],V)});return V};f.memoize=function(U,V){var W={};V||(V=f.identity);return function(){var X=V.apply(this,arguments);return f.has(W,X)?W[X]:(W[X]=U.apply(this,arguments))}};f.delay=function(V,W){var U=S.call(arguments,2);return setTimeout(function(){return V.apply(null,U)},W)};f.defer=function(U){return f.delay.apply(f,[U,1].concat(S.call(arguments,1)))};f.throttle=function(W,ac,Y){var V,U,aa;var ab=null;var Z=0;Y||(Y={});var X=function(){Z=Y.leading===false?0:new Date;ab=null;aa=W.apply(V,U)};return function(){var ad=new Date;if(!Z&&Y.leading===false){Z=ad}var ae=ac-(ad-Z);V=this;U=arguments;if(ae<=0){clearTimeout(ab);ab=null;Z=ad;aa=W.apply(V,U)}else{if(!ab&&Y.trailing!==false){ab=setTimeout(X,ae)}}return aa}};f.debounce=function(W,ab,X){var Z,U,V,aa,Y;return function(){V=this;U=arguments;aa=new Date();var ad=function(){var ae=(new Date())-aa;if(ae<ab){Z=setTimeout(ad,ab-ae)}else{Z=null;if(!X){Y=W.apply(V,U)}}};var ac=X&&!Z;if(!Z){Z=setTimeout(ad,ab)}if(ac){Y=W.apply(V,U)}return Y}};f.once=function(U){var W=false,V;return function(){if(W){return V}W=true;V=U.apply(this,arguments);U=null;return V}};f.wrap=function(U,V){return function(){var W=[U];O.apply(W,arguments);return V.apply(this,W)}};f.compose=function(){var U=arguments;return function(){var V=arguments;for(var W=U.length-1;W>=0;W--){V=[U[W].apply(this,V)]}return V[0]}};f.after=function(V,U){return function(){if(--V<1){return U.apply(this,arguments)}}};f.keys=F||function(W){if(W!==Object(W)){throw new TypeError("Invalid object")}var V=[];for(var U in W){if(f.has(W,U)){V.push(U)}}return V};f.values=function(X){var V=f.keys(X);var W=V.length;var Y=new Array(W);for(var U=0;U<W;U++){Y[U]=X[V[U]]}return Y};f.pairs=function(X){var V=f.keys(X);var W=V.length;var Y=new Array(W);for(var U=0;U<W;U++){Y[U]=[V[U],X[V[U]]]}return Y};f.invert=function(X){var Y={};var V=f.keys(X);for(var U=0,W=V.length;U<W;U++){Y[X[V[U]]]=V[U]}return Y};f.functions=f.methods=function(W){var V=[];for(var U in W){if(f.isFunction(W[U])){V.push(U)}}return V.sort()};f.extend=function(U){m(S.call(arguments,1),function(W){if(W){for(var V in W){U[V]=W[V]}}});return U};f.pick=function(W){var U={};var V=k.apply(i,S.call(arguments,1));m(V,function(X){if(X in W){U[X]=W[X]}});return U};f.omit=function(X){var U={};var W=k.apply(i,S.call(arguments,1));for(var V in X){if(!f.contains(W,V)){U[V]=X[V]}}return U};f.defaults=function(U){m(S.call(arguments,1),function(W){if(W){for(var V in W){if(U[V]===void 0){U[V]=W[V]}}}});return U};f.clone=function(U){if(!f.isObject(U)){return U}return f.isArray(U)?U.slice():f.extend({},U)};f.tap=function(V,U){U(V);return V};var p=function(U,X,W,Z){if(U===X){return U!==0||1/U==1/X}if(U==null||X==null){return U===X}if(U instanceof f){U=U._wrapped}if(X instanceof f){X=X._wrapped}var aa=T.call(U);if(aa!=T.call(X)){return false}switch(aa){case"[object String]":return U==String(X);case"[object Number]":return U!=+U?X!=+X:(U==0?1/U==1/X:U==+X);case"[object Date]":case"[object Boolean]":return +U==+X;case"[object RegExp]":return U.source==X.source&&U.global==X.global&&U.multiline==X.multiline&&U.ignoreCase==X.ignoreCase}if(typeof U!="object"||typeof X!="object"){return false}var ac=W.length;while(ac--){if(W[ac]==U){return Z[ac]==X}}var V=U.constructor,Y=X.constructor;if(V!==Y&&!(f.isFunction(V)&&(V instanceof V)&&f.isFunction(Y)&&(Y instanceof Y))){return false}W.push(U);Z.push(X);var ae=0,ad=true;if(aa=="[object Array]"){ae=U.length;ad=ae==X.length;if(ad){while(ae--){if(!(ad=p(U[ae],X[ae],W,Z))){break}}}}else{for(var ab in U){if(f.has(U,ab)){ae++;if(!(ad=f.has(X,ab)&&p(U[ab],X[ab],W,Z))){break}}}if(ad){for(ab in X){if(f.has(X,ab)&&!(ae--)){break}}ad=!ae}}W.pop();Z.pop();return ad};f.isEqual=function(U,V){return p(U,V,[],[])};f.isEmpty=function(V){if(V==null){return true}if(f.isArray(V)||f.isString(V)){return V.length===0}for(var U in V){if(f.has(V,U)){return false}}return true};f.isElement=function(U){return !!(U&&U.nodeType===1)};f.isArray=E||function(U){return T.call(U)=="[object Array]"};f.isObject=function(U){return U===Object(U)};m(["Arguments","Function","String","Number","Date","RegExp"],function(U){f["is"+U]=function(V){return T.call(V)=="[object "+U+"]"}});if(!f.isArguments(arguments)){f.isArguments=function(U){return !!(U&&f.has(U,"callee"))}}if(typeof(/./)!=="function"){f.isFunction=function(U){return typeof U==="function"}}f.isFinite=function(U){return isFinite(U)&&!isNaN(parseFloat(U))};f.isNaN=function(U){return f.isNumber(U)&&U!=+U};f.isBoolean=function(U){return U===true||U===false||T.call(U)=="[object Boolean]"};f.isNull=function(U){return U===null};f.isUndefined=function(U){return U===void 0};f.has=function(V,U){return w.call(V,U)};f.noConflict=function(){R._=N;return this};f.identity=function(U){return U};f.times=function(Y,X,V){var U=Array(Math.max(0,Y));for(var W=0;W<Y;W++){U[W]=X.call(V,W)}return U};f.random=function(V,U){if(U==null){U=V;V=0}return V+Math.floor(Math.random()*(U-V+1))};var n={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};n.unescape=f.invert(n.escape);var o={escape:new RegExp("["+f.keys(n.escape).join("")+"]","g"),unescape:new RegExp("("+f.keys(n.unescape).join("|")+")","g")};f.each(["escape","unescape"],function(U){f[U]=function(V){if(V==null){return""}return(""+V).replace(o[U],function(W){return n[U][W]})}});f.result=function(U,V){if(U==null){return void 0}var W=U[V];return f.isFunction(W)?W.call(U):W};f.mixin=function(U){m(f.functions(U),function(W){var V=f[W]=U[W];f.prototype[W]=function(){var X=[this._wrapped];O.apply(X,arguments);return Q.call(this,V.apply(f,X))}})};var x=0;f.uniqueId=function(V){var U=++x+"";return V?V+U:U};f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/;var s={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var q=/\\|'|\r|\n|\t|\u2028|\u2029/g;f.template=function(ac,U,Z){var Y;Z=f.defaults({},Z,f.templateSettings);var X=new RegExp([(Z.escape||L).source,(Z.interpolate||L).source,(Z.evaluate||L).source].join("|")+"|$","g");var W=0;var aa="__p+='";ac.replace(X,function(ag,ad,af,ae,ah){aa+=ac.slice(W,ah).replace(q,function(ai){return"\\"+s[ai]});if(ad){aa+="'+\n((__t=("+ad+"))==null?'':_.escape(__t))+\n'"}if(af){aa+="'+\n((__t=("+af+"))==null?'':__t)+\n'"}if(ae){aa+="';\n"+ae+"\n__p+='"}W=ah+ag.length;return ag});aa+="';\n";if(!Z.variable){aa="with(obj||{}){\n"+aa+"}\n"}aa="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+aa+"return __p;\n";try{Y=new Function(Z.variable||"obj","_",aa)}catch(V){V.source=aa;throw V}if(U){return Y(U,f)}var ab=function(ad){return Y.call(this,ad,f)};ab.source="function("+(Z.variable||"obj")+"){\n"+aa+"}";return ab};f.chain=function(U){return f(U).chain()};var Q=function(U){return this._chain?f(U).chain():U};f.mixin(f);m(["pop","push","reverse","shift","sort","splice","unshift"],function(V){var U=i[V];f.prototype[V]=function(){var W=this._wrapped;U.apply(W,arguments);if((V=="shift"||V=="splice")&&W.length===0){delete W[0]}return Q.call(this,W)}});m(["concat","join","slice"],function(V){var U=i[V];f.prototype[V]=function(){return Q.call(this,U.apply(this._wrapped,arguments))}});f.extend(f.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this)},{}],15:[function(d,c,a){(function(){var k=this;var j=k.humanize;var i={};if(typeof a!=="undefined"){if(typeof c!=="undefined"&&c.exports){a=c.exports=i}a.humanize=i}else{if(typeof define==="function"&&define.amd){define("humanize",function(){return i})}k.humanize=i}i.noConflict=function(){k.humanize=j;return this};i.pad=function(n,l,m,o){n+="";if(!m){m=" "}else{if(m.length>1){m=m.charAt(0)}}o=(o===undefined)?"left":"right";if(o==="right"){while(n.length<l){n=n+m}}else{while(n.length<l){n=m+n}}return n};i.time=function(){return new Date().getTime()/1000};var f=[0,0,31,59,90,120,151,181,212,243,273,304,334];var h=[0,0,31,60,91,121,152,182,213,244,274,305,335];i.date=function(m,t){var p=((t===undefined)?new Date():(t instanceof Date)?new Date(t):new Date(t*1000));var n=/\\?([a-z])/gi;var o=function(v,u){return l[v]?l[v]():u};var s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var q=["January","February","March","April","May","June","July","August","September","October","November","December"];var l={d:function(){return i.pad(l.j(),2,"0")},D:function(){return l.l().slice(0,3)},j:function(){return p.getDate()},l:function(){return s[l.w()]},N:function(){return l.w()||7},S:function(){var u=l.j();return u>4&&u<21?"th":{1:"st",2:"nd",3:"rd"}[u%10]||"th"},w:function(){return p.getDay()},z:function(){return(l.L()?h[l.n()]:f[l.n()])+l.j()-1},W:function(){var u=l.z()-l.N()+1.5;return i.pad(1+Math.floor(Math.abs(u)/7)+(u%7>3.5?1:0),2,"0")},F:function(){return q[p.getMonth()]},m:function(){return i.pad(l.n(),2,"0")},M:function(){return l.F().slice(0,3)},n:function(){return p.getMonth()+1},t:function(){return(new Date(l.Y(),l.n(),0)).getDate()},L:function(){return new Date(l.Y(),1,29).getMonth()===1?1:0},o:function(){var u=l.n();var v=l.W();return l.Y()+(u===12&&v<9?-1:u===1&&v>9)},Y:function(){return p.getFullYear()},y:function(){return(String(l.Y())).slice(-2)},a:function(){return p.getHours()>11?"pm":"am"},A:function(){return l.a().toUpperCase()},B:function(){var w=p.getTime()/1000;var v=w%86400+3600;if(v<0){v+=86400}var u=((v)/86.40000000000001)%1000;if(w<0){return Math.ceil(u)}return Math.floor(u)},g:function(){return l.G()%12||12},G:function(){return p.getHours()},h:function(){return i.pad(l.g(),2,"0")},H:function(){return i.pad(l.G(),2,"0")},i:function(){return i.pad(p.getMinutes(),2,"0")},s:function(){return i.pad(p.getSeconds(),2,"0")},u:function(){return i.pad(p.getMilliseconds()*1000,6,"0")},O:function(){var u=p.getTimezoneOffset();var v=Math.abs(u);return(u>0?"-":"+")+i.pad(Math.floor(v/60)*100+v%60,4,"0")},P:function(){var u=l.O();return(u.substr(0,3)+":"+u.substr(3,2))},Z:function(){return -p.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(n,o)},r:function(){return"D, d M Y H:i:s O".replace(n,o)},U:function(){return p.getTime()/1000||0}};return m.replace(n,o)};i.numberFormat=function(p,l,m,s){l=isNaN(l)?2:Math.abs(l);m=(m===undefined)?".":m;s=(s===undefined)?",":s;var q=p<0?"-":"";p=Math.abs(+p||0);var n=parseInt(p.toFixed(l),10)+"";var o=n.length>3?n.length%3:0;return q+(o?n.substr(0,o)+s:"")+n.substr(o).replace(/(\d{3})(?=\d)/g,"$1"+s)+(l?m+Math.abs(p-n).toFixed(l).slice(2):"")};i.naturalDay=function(o,m){o=(o===undefined)?i.time():o;m=(m===undefined)?"Y-m-d":m;var n=86400;var l=new Date();var p=(new Date(l.getFullYear(),l.getMonth(),l.getDate())).getTime()/1000;if(o<p&&o>=p-n){return"yesterday"}else{if(o>=p&&o<p+n){return"today"}else{if(o>=p+n&&o<p+2*n){return"tomorrow"}}}return i.date(m,o)};i.relativeTime=function(u){u=(u===undefined)?i.time():u;var l=i.time();var t=l-u;if(t<2&&t>-2){return(t>=0?"just ":"")+"now"}if(t<60&&t>-60){return(t>=0?Math.floor(t)+" seconds ago":"in "+Math.floor(-t)+" seconds")}if(t<120&&t>-120){return(t>=0?"about a minute ago":"in about a minute")}if(t<3600&&t>-3600){return(t>=0?Math.floor(t/60)+" minutes ago":"in "+Math.floor(-t/60)+" minutes")}if(t<7200&&t>-7200){return(t>=0?"about an hour ago":"in about an hour")}if(t<86400&&t>-86400){return(t>=0?Math.floor(t/3600)+" hours ago":"in "+Math.floor(-t/3600)+" hours")}var o=2*86400;if(t<o&&t>-o){return(t>=0?"1 day ago":"in 1 day")}var p=29*86400;if(t<p&&t>-p){return(t>=0?Math.floor(t/86400)+" days ago":"in "+Math.floor(-t/86400)+" days")}var q=60*86400;if(t<q&&t>-q){return(t>=0?"about a month ago":"in about a month")}var n=parseInt(i.date("Y",l),10);var w=parseInt(i.date("Y",u),10);var m=n*12+parseInt(i.date("n",l),10);var v=w*12+parseInt(i.date("n",u),10);var s=m-v;if(s<12&&s>-12){return(s>=0?s+" months ago":"in "+(-s)+" months")}var x=n-w;if(x<2&&x>-2){return(x>=0?"a year ago":"in a year")}return(x>=0?x+" years ago":"in "+(-x)+" years")};i.ordinal=function(l){l=parseInt(l,10);l=isNaN(l)?0:l;var m=l<0?"-":"";l=Math.abs(l);var n=l%100;return m+l+(n>4&&n<21?"th":{1:"st",2:"nd",3:"rd"}[l%10]||"th")};i.filesize=function(n,o,l,m,q,p){o=(o===undefined)?1024:o;if(n<=0){return"0 bytes"}if(n<o&&l===undefined){l=0}if(p===undefined){p=" "}return i.intword(n,["bytes","KB","MB","GB","TB","PB"],o,l,m,q,p)};i.intword=function(q,w,p,l,m,u,t){var n,v;w=w||["","K","M","B","T"],v=w.length-1,p=p||1000,l=isNaN(l)?2:Math.abs(l),m=m||".",u=u||",",t=t||"";for(var o=0;o<w.length;o++){if(q<Math.pow(p,o+1)){v=o;break}}n=q/Math.pow(p,v);var s=w[v]?t+w[v]:"";return i.numberFormat(n,l,m,u)+s};i.linebreaks=function(l){l=l.replace(/^([\n|\r]*)/,"");l=l.replace(/([\n|\r]*)$/,"");l=l.replace(/(\r\n|\n|\r)/g,"\n");l=l.replace(/(\n{2,})/g,"</p><p>");l=l.replace(/\n/g,"<br />");return"<p>"+l+"</p>"};i.nl2br=function(l){return l.replace(/(\r\n|\n|\r)/g,"<br />")};i.truncatechars=function(m,l){if(m.length<=l){return m}return m.substr(0,l)+"…"};i.truncatewords=function(m,l){var n=m.split(" ");if(n.length<l){return m}return n.slice(0,l).join(" ")+"…"}}).call(this)},{}],16:[function(d,c,a){(function(){var G=this;var C=G._;var h=Array.prototype,B=Object.prototype,t=Function.prototype;var D=h.push,H=h.slice,i=h.concat,I=B.toString,v=B.hasOwnProperty;var y=Array.isArray,z=Object.keys,x=t.bind;var f=function(K){if(K instanceof f){return K}if(!(this instanceof f)){return new f(K)}this._wrapped=K};if(typeof a!=="undefined"){if(typeof c!=="undefined"&&c.exports){a=c.exports=f}a._=f}else{G._=f}f.VERSION="1.7.0";var j=function(M,L,K){if(L===void 0){return M}switch(K==null?3:K){case 1:return function(N){return M.call(L,N)};case 2:return function(O,N){return M.call(L,O,N)};case 3:return function(P,O,N){return M.call(L,P,O,N)};case 4:return function(N,Q,P,O){return M.call(L,N,Q,P,O)}}return function(){return M.apply(L,arguments)}};f.iteratee=function(M,L,K){if(M==null){return f.identity}if(f.isFunction(M)){return j(M,L,K)}if(f.isObject(M)){return f.matches(M)}return f.property(M)};f.each=f.forEach=function(P,M,K){if(P==null){return P}M=j(M,K);var L,O=P.length;if(O===+O){for(L=0;L<O;L++){M(P[L],L,P)}}else{var N=f.keys(P);for(L=0,O=N.length;L<O;L++){M(P[N[L]],N[L],P)}}return P};f.map=f.collect=function(Q,N,K){if(Q==null){return[]}N=f.iteratee(N,K);var O=Q.length!==+Q.length&&f.keys(Q),P=(O||Q).length,R=Array(P),L;for(var M=0;M<P;M++){L=O?O[M]:M;R[M]=N(Q[L],L,Q)}return R};var E="Reduce of empty array with no initial value";f.reduce=f.foldl=f.inject=function(R,N,Q,K){if(R==null){R=[]}N=j(N,K,4);var O=R.length!==+R.length&&f.keys(R),P=(O||R).length,M=0,L;if(arguments.length<3){if(!P){throw new TypeError(E)}Q=R[O?O[M++]:M++]}for(;M<P;M++){L=O?O[M]:M;Q=N(Q,R[L],L,R)}return Q};f.reduceRight=f.foldr=function(Q,N,P,K){if(Q==null){Q=[]}N=j(N,K,4);var O=Q.length!==+Q.length&&f.keys(Q),M=(O||Q).length,L;if(arguments.length<3){if(!M){throw new TypeError(E)}P=Q[O?O[--M]:--M]}while(M--){L=O?O[M]:M;P=N(P,Q[L],L,Q)}return P};f.find=f.detect=function(L,M,K){var N;M=f.iteratee(M,K);f.some(L,function(Q,O,P){if(M(Q,O,P)){N=Q;return true}});return N};f.filter=f.select=function(L,M,K){var N=[];if(L==null){return N}M=f.iteratee(M,K);f.each(L,function(Q,O,P){if(M(Q,O,P)){N.push(Q)}});return N};f.reject=function(L,M,K){return f.filter(L,f.negate(f.iteratee(M)),K)};f.every=f.all=function(P,Q,K){if(P==null){return true}Q=f.iteratee(Q,K);var N=P.length!==+P.length&&f.keys(P),O=(N||P).length,M,L;for(M=0;M<O;M++){L=N?N[M]:M;if(!Q(P[L],L,P)){return false}}return true};f.some=f.any=function(P,Q,K){if(P==null){return false}Q=f.iteratee(Q,K);var N=P.length!==+P.length&&f.keys(P),O=(N||P).length,M,L;for(M=0;M<O;M++){L=N?N[M]:M;if(Q(P[L],L,P)){return true}}return false};f.contains=f.include=function(K,L){if(K==null){return false}if(K.length!==+K.length){K=f.values(K)}return f.indexOf(K,L)>=0};f.invoke=function(N,M){var K=H.call(arguments,2);var L=f.isFunction(M);return f.map(N,function(O){return(L?M:O[M]).apply(O,K)})};f.pluck=function(L,K){return f.map(L,f.property(K))};f.where=function(L,K){return f.filter(L,f.matches(K))};f.findWhere=function(L,K){return f.find(L,f.matches(K))};f.max=function(Q,N,L){var R=-Infinity,O=-Infinity,S,K;if(N==null&&Q!=null){Q=Q.length===+Q.length?Q:f.values(Q);for(var M=0,P=Q.length;M<P;M++){S=Q[M];if(S>R){R=S}}}else{N=f.iteratee(N,L);f.each(Q,function(V,T,U){K=N(V,T,U);if(K>O||K===-Infinity&&R===-Infinity){R=V;O=K}})}return R};f.min=function(Q,N,L){var R=Infinity,O=Infinity,S,K;if(N==null&&Q!=null){Q=Q.length===+Q.length?Q:f.values(Q);for(var M=0,P=Q.length;M<P;M++){S=Q[M];if(S<R){R=S}}}else{N=f.iteratee(N,L);f.each(Q,function(V,T,U){K=N(V,T,U);if(K<O||K===Infinity&&R===Infinity){R=V;O=K}})}return R};f.shuffle=function(M){var O=M&&M.length===+M.length?M:f.values(M);var L=O.length;var P=Array(L);for(var K=0,N;K<L;K++){N=f.random(0,K);if(N!==K){P[K]=P[N]}P[N]=O[K]}return P};f.sample=function(M,L,K){if(L==null||K){if(M.length!==+M.length){M=f.values(M)}return M[f.random(M.length-1)]}return f.shuffle(M).slice(0,Math.max(0,L))};f.sortBy=function(M,L,K){L=f.iteratee(L,K);return f.pluck(f.map(M,function(P,N,O){return{value:P,index:N,criteria:L(P,N,O)}}).sort(function(P,Q){var N=P.criteria;var O=Q.criteria;if(N!==O){if(N>O||N===void 0){return 1}if(N<O||O===void 0){return -1}}return P.index-Q.index}),"value")};var u=function(K){return function(N,M,L){var O={};M=f.iteratee(M,L);f.each(N,function(R,P){var Q=M(R,P,N);K(O,R,Q)});return O}};f.groupBy=u(function(L,M,K){if(f.has(L,K)){L[K].push(M)}else{L[K]=[M]}});f.indexBy=u(function(L,M,K){L[K]=M});f.countBy=u(function(L,M,K){if(f.has(L,K)){L[K]++}else{L[K]=1}});f.sortedIndex=function(K,Q,N,L){N=f.iteratee(N,L,1);var R=N(Q);var O=0,M=K.length;while(O<M){var P=O+M>>>1;if(N(K[P])<R){O=P+1}else{M=P}}return O};f.toArray=function(K){if(!K){return[]}if(f.isArray(K)){return H.call(K)}if(K.length===+K.length){return f.map(K,f.identity)}return f.values(K)};f.size=function(K){if(K==null){return 0}return K.length===+K.length?K.length:f.keys(K).length};f.partition=function(M,O,K){O=f.iteratee(O,K);var N=[],L=[];f.each(M,function(R,P,Q){(O(R,P,Q)?N:L).push(R)});return[N,L]};f.first=f.head=f.take=function(K,M,L){if(K==null){return void 0}if(M==null||L){return K[0]}if(M<0){return[]}return H.call(K,0,M)};f.initial=function(K,M,L){return H.call(K,0,Math.max(0,K.length-(M==null||L?1:M)))};f.last=function(K,M,L){if(K==null){return void 0}if(M==null||L){return K[K.length-1]}return H.call(K,Math.max(K.length-M,0))};f.rest=f.tail=f.drop=function(K,M,L){return H.call(K,M==null||L?1:M)};f.compact=function(K){return f.filter(K,f.identity)};var s=function(L,O,P,N){if(O&&f.every(L,f.isArray)){return i.apply(N,L)}for(var K=0,M=L.length;K<M;K++){var Q=L[K];if(!f.isArray(Q)&&!f.isArguments(Q)){if(!P){N.push(Q)}}else{if(O){D.apply(N,Q)}else{s(Q,O,P,N)}}}return N};f.flatten=function(K,L){return s(K,L,false,[])};f.without=function(K){return f.difference(K,H.call(arguments,1))};f.uniq=f.unique=function(K,O,P,M){if(K==null){return[]}if(!f.isBoolean(O)){M=P;P=O;O=false}if(P!=null){P=f.iteratee(P,M)}var R=[];var S=[];for(var N=0,Q=K.length;N<Q;N++){var T=K[N];if(O){if(!N||S!==T){R.push(T)}S=T}else{if(P){var L=P(T,N,K);if(f.indexOf(S,L)<0){S.push(L);R.push(T)}}else{if(f.indexOf(R,T)<0){R.push(T)}}}}return R};f.union=function(){return f.uniq(s(arguments,true,true,[]))};f.intersection=function(L){if(L==null){return[]}var Q=[];var K=arguments.length;for(var M=0,P=L.length;M<P;M++){var N=L[M];if(f.contains(Q,N)){continue}for(var O=1;O<K;O++){if(!f.contains(arguments[O],N)){break}}if(O===K){Q.push(N)}}return Q};f.difference=function(K){var L=s(H.call(arguments,1),true,true,[]);return f.filter(K,function(M){return !f.contains(L,M)})};f.zip=function(K){if(K==null){return[]}var M=f.max(arguments,"length").length;var N=Array(M);for(var L=0;L<M;L++){N[L]=f.pluck(arguments,L)}return N};f.object=function(M,O){if(M==null){return{}}var N={};for(var K=0,L=M.length;K<L;K++){if(O){N[M[K]]=O[K]}else{N[M[K][0]]=M[K][1]}}return N};f.indexOf=function(K,N,M){if(K==null){return -1}var L=0,O=K.length;if(M){if(typeof M=="number"){L=M<0?Math.max(0,O+M):M}else{L=f.sortedIndex(K,N);return K[L]===N?L:-1}}for(;L<O;L++){if(K[L]===N){return L}}return -1};f.lastIndexOf=function(K,N,L){if(K==null){return -1}var M=K.length;if(typeof L=="number"){M=L<0?M+L+1:Math.min(M,L+1)}while(--M>=0){if(K[M]===N){return M}}return -1};f.range=function(N,P,O){if(arguments.length<=1){P=N||0;N=0}O=O||1;var L=Math.max(Math.ceil((P-N)/O),0);var M=Array(L);for(var K=0;K<L;K++,N+=O){M[K]=N}return M};var l=function(){};f.bind=function(N,M){var K,L;if(x&&N.bind===x){return x.apply(N,H.call(arguments,1))}if(!f.isFunction(N)){throw new TypeError("Bind must be called on a function")}K=H.call(arguments,2);L=function(){if(!(this instanceof L)){return N.apply(M,K.concat(H.call(arguments)))}l.prototype=N.prototype;var P=new l;l.prototype=null;var O=N.apply(P,K.concat(H.call(arguments)));if(f.isObject(O)){return O}return P};return L};f.partial=function(L){var K=H.call(arguments,1);return function(){var P=0;var M=K.slice();for(var N=0,O=M.length;N<O;N++){if(M[N]===f){M[N]=arguments[P++]}}while(P<arguments.length){M.push(arguments[P++])}return L.apply(this,M)}};f.bindAll=function(N){var K,M=arguments.length,L;if(M<=1){throw new Error("bindAll must be passed function names")}for(K=1;K<M;K++){L=arguments[K];N[L]=f.bind(N[L],N)}return N};f.memoize=function(K,L){var M=function(P){var O=M.cache;var N=L?L.apply(this,arguments):P;if(!f.has(O,N)){O[N]=K.apply(this,arguments)}return O[N]};M.cache={};return M};f.delay=function(L,M){var K=H.call(arguments,2);return setTimeout(function(){return L.apply(null,K)},M)};f.defer=function(K){return f.delay.apply(f,[K,1].concat(H.call(arguments,1)))};f.throttle=function(M,S,O){var L,K,Q;var R=null;var P=0;if(!O){O={}}var N=function(){P=O.leading===false?0:f.now();R=null;Q=M.apply(L,K);if(!R){L=K=null}};return function(){var T=f.now();if(!P&&O.leading===false){P=T}var U=S-(T-P);L=this;K=arguments;if(U<=0||U>S){clearTimeout(R);R=null;P=T;Q=M.apply(L,K);if(!R){L=K=null}}else{if(!R&&O.trailing!==false){R=setTimeout(N,U)}}return Q}};f.debounce=function(M,S,N){var Q,K,L,R,P;var O=function(){var T=f.now()-R;if(T<S&&T>0){Q=setTimeout(O,S-T)}else{Q=null;if(!N){P=M.apply(L,K);if(!Q){L=K=null}}}};return function(){L=this;K=arguments;R=f.now();var T=N&&!Q;if(!Q){Q=setTimeout(O,S)}if(T){P=M.apply(L,K);L=K=null}return P}};f.wrap=function(K,L){return f.partial(L,K)};f.negate=function(K){return function(){return !K.apply(this,arguments)}};f.compose=function(){var K=arguments;var L=K.length-1;return function(){var M=L;var N=K[L].apply(this,arguments);while(M--){N=K[M].call(this,N)}return N}};f.after=function(L,K){return function(){if(--L<1){return K.apply(this,arguments)}}};f.before=function(M,K){var L;return function(){if(--M>0){L=K.apply(this,arguments)}else{K=null}return L}};f.once=f.partial(f.before,2);f.keys=function(M){if(!f.isObject(M)){return[]}if(z){return z(M)}var L=[];for(var K in M){if(f.has(M,K)){L.push(K)}}return L};f.values=function(N){var L=f.keys(N);var M=L.length;var O=Array(M);for(var K=0;K<M;K++){O[K]=N[L[K]]}return O};f.pairs=function(N){var L=f.keys(N);var M=L.length;var O=Array(M);for(var K=0;K<M;K++){O[K]=[L[K],N[L[K]]]}return O};f.invert=function(N){var O={};var L=f.keys(N);for(var K=0,M=L.length;K<M;K++){O[N[L[K]]]=L[K]}return O};f.functions=f.methods=function(M){var L=[];for(var K in M){if(f.isFunction(M[K])){L.push(K)}}return L.sort()};f.extend=function(M){if(!f.isObject(M)){return M}var O,N;for(var K=1,L=arguments.length;K<L;K++){O=arguments[K];for(N in O){if(v.call(O,N)){M[N]=O[N]}}}return M};f.pick=function(Q,M,K){var R={},N;if(Q==null){return R}if(f.isFunction(M)){M=j(M,K);for(N in Q){var S=Q[N];if(M(S,N,Q)){R[N]=S}}}else{var O=i.apply([],H.call(arguments,1));Q=new Object(Q);for(var L=0,P=O.length;L<P;L++){N=O[L];if(N in Q){R[N]=Q[N]}}}return R};f.omit=function(N,L,K){if(f.isFunction(L)){L=f.negate(L)}else{var M=f.map(i.apply([],H.call(arguments,1)),String);L=function(P,O){return !f.contains(M,O)}}return f.pick(N,L,K)};f.defaults=function(M){if(!f.isObject(M)){return M}for(var K=1,L=arguments.length;K<L;K++){var O=arguments[K];for(var N in O){if(M[N]===void 0){M[N]=O[N]}}}return M};f.clone=function(K){if(!f.isObject(K)){return K}return f.isArray(K)?K.slice():f.extend({},K)};f.tap=function(L,K){K(L);return L};var m=function(K,N,M,P){if(K===N){return K!==0||1/K===1/N}if(K==null||N==null){return K===N}if(K instanceof f){K=K._wrapped}if(N instanceof f){N=N._wrapped}var Q=I.call(K);if(Q!==I.call(N)){return false}switch(Q){case"[object RegExp]":case"[object String]":return""+K===""+N;case"[object Number]":if(+K!==+K){return +N!==+N}return +K===0?1/+K===1/N:+K===+N;case"[object Date]":case"[object Boolean]":return +K===+N}if(typeof K!="object"||typeof N!="object"){return false}var T=M.length;while(T--){if(M[T]===K){return P[T]===N}}var L=K.constructor,O=N.constructor;if(L!==O&&"constructor" in K&&"constructor" in N&&!(f.isFunction(L)&&L instanceof L&&f.isFunction(O)&&O instanceof O)){return false}M.push(K);P.push(N);var V,U;if(Q==="[object Array]"){V=K.length;U=V===N.length;if(U){while(V--){if(!(U=m(K[V],N[V],M,P))){break}}}}else{var S=f.keys(K),R;V=S.length;U=f.keys(N).length===V;if(U){while(V--){R=S[V];if(!(U=f.has(N,R)&&m(K[R],N[R],M,P))){break}}}}M.pop();P.pop();return U};f.isEqual=function(K,L){return m(K,L,[],[])};f.isEmpty=function(L){if(L==null){return true}if(f.isArray(L)||f.isString(L)||f.isArguments(L)){return L.length===0}for(var K in L){if(f.has(L,K)){return false}}return true};f.isElement=function(K){return !!(K&&K.nodeType===1)};f.isArray=y||function(K){return I.call(K)==="[object Array]"};f.isObject=function(K){var L=typeof K;return L==="function"||L==="object"&&!!K};f.each(["Arguments","Function","String","Number","Date","RegExp"],function(K){f["is"+K]=function(L){return I.call(L)==="[object "+K+"]"}});if(!f.isArguments(arguments)){f.isArguments=function(K){return f.has(K,"callee")}}if(typeof/./!=="function"){f.isFunction=function(K){return typeof K=="function"||false}}f.isFinite=function(K){return isFinite(K)&&!isNaN(parseFloat(K))};f.isNaN=function(K){return f.isNumber(K)&&K!==+K};f.isBoolean=function(K){return K===true||K===false||I.call(K)==="[object Boolean]"};f.isNull=function(K){return K===null};f.isUndefined=function(K){return K===void 0};f.has=function(L,K){return L!=null&&v.call(L,K)};f.noConflict=function(){G._=C;return this};f.identity=function(K){return K};f.constant=function(K){return function(){return K}};f.noop=function(){};f.property=function(K){return function(L){return L[K]}};f.matches=function(K){var M=f.pairs(K),L=M.length;return function(P){if(P==null){return !L}P=new Object(P);for(var N=0;N<L;N++){var Q=M[N],O=Q[0];if(Q[1]!==P[O]||!(O in P)){return false}}return true}};f.times=function(O,N,L){var K=Array(Math.max(0,O));N=j(N,L,1);for(var M=0;M<O;M++){K[M]=N(M)}return K};f.random=function(L,K){if(K==null){K=L;L=0}return L+Math.floor(Math.random()*(K-L+1))};f.now=Date.now||function(){return new Date().getTime()};var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var J=f.invert(o);var k=function(L){var K=function(P){return L[P]};var N="(?:"+f.keys(L).join("|")+")";var O=RegExp(N);var M=RegExp(N,"g");return function(P){P=P==null?"":""+P;return O.test(P)?P.replace(M,K):P}};f.escape=k(o);f.unescape=k(J);f.result=function(K,L){if(K==null){return void 0}var M=K[L];return f.isFunction(M)?K[L]():M};var w=0;f.uniqueId=function(L){var K=++w+"";return L?L+K:K};f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/;var q={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};var p=/\\|'|\r|\n|\u2028|\u2029/g;var n=function(K){return"\\"+q[K]};f.template=function(T,Q,O){if(!Q&&O){Q=O}Q=f.defaults({},Q,f.templateSettings);var N=RegExp([(Q.escape||A).source,(Q.interpolate||A).source,(Q.evaluate||A).source].join("|")+"|$","g");var M=0;var R="__p+='";T.replace(N,function(X,U,W,V,Y){R+=T.slice(M,Y).replace(p,n);M=Y+X.length;if(U){R+="'+\n((__t=("+U+"))==null?'':_.escape(__t))+\n'"}else{if(W){R+="'+\n((__t=("+W+"))==null?'':__t)+\n'"}else{if(V){R+="';\n"+V+"\n__p+='"}}}return X});R+="';\n";if(!Q.variable){R="with(obj||{}){\n"+R+"}\n"}R="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+R+"return __p;\n";try{var P=new Function(Q.variable||"obj","_",R)}catch(L){L.source=R;throw L}var S=function(U){return P.call(this,U,f)};var K=Q.variable||"obj";S.source="function("+K+"){\n"+R+"}";return S};f.chain=function(L){var K=f(L);K._chain=true;return K};var F=function(K){return this._chain?f(K).chain():K};f.mixin=function(K){f.each(f.functions(K),function(M){var L=f[M]=K[M];f.prototype[M]=function(){var N=[this._wrapped];D.apply(N,arguments);return F.call(this,L.apply(f,N))}})};f.mixin(f);f.each(["pop","push","reverse","shift","sort","splice","unshift"],function(L){var K=h[L];f.prototype[L]=function(){var M=this._wrapped;K.apply(M,arguments);if((L==="shift"||L==="splice")&&M.length===0){delete M[0]}return F.call(this,M)}});f.each(["concat","join","slice"],function(L){var K=h[L];f.prototype[L]=function(){return F.call(this,K.apply(this._wrapped,arguments))}});f.prototype.value=function(){return this._wrapped};if(typeof define==="function"&&define.amd){define("underscore",[],function(){return f})}}.call(this))},{}],17:[function(k,i,d){var a=k("underscore");var f=k("geocrunch");var j=function(l){return l<10?"0"+l.toString():l.toString()};var c=function(l,u,t){var o=Math.abs(l),n=Math.floor(o),q=Math.floor((o-n)*60),v=Math.round((o-n-(q/60))*3600*100)/100,p=o===l?u:t;return j(n)+"&deg; "+j(q)+"' "+j(v)+'" '+p};var h=function(q){var p=a.last(q),m,s,t,o,v,l,n,w;var u=f.path(a.map(q,function(x){return[x.lng,x.lat]}));m=u.distance({units:"feet"});s=m/3.2808;t=m/5280;o=s/1000;v=u.area({units:"sqmeters"});l=v*0.00024711;n=v/10000;w=l*0.0015625;return{lastCoord:{dd:{x:p.lng,y:p.lat},dms:{x:c(p.lng,"E","W"),y:c(p.lat,"N","S")}},length:{feet:m,meters:s,miles:t,kilometers:o},area:{acres:l,hectares:n,sqmeters:v,sqmiles:w}}};i.exports={measure:h}},{geocrunch:6,underscore:16}],18:[function(f,d,a){var i=function(l,k){if(!k){k=document}return k.querySelector(l)};var h=function(l,k){if(!k){k=document}return Array.prototype.slice.call(k.querySelectorAll(l))};var c=function(k){if(k){k.setAttribute("style","display:none;");return k}};var j=function(k){if(k){k.removeAttribute("style");return k}};d.exports={$:i,$$:h,hide:c,show:j}},{}],19:[function(d,c,a){(function(m){var h=d("underscore");var o=(typeof window!=="undefined"?window.L:typeof m!=="undefined"?m.L:null);var n=d("humanize");var u=d("./units");var j=d("./calc");var l=d("./dom");var f=l.$;var t=d("./mapsymbology");var k=h.template('<a class="<%= model.className %>-toggle js-toggle" href="#" title="Measure distances and areas">Measure</a>\n<div class="<%= model.className %>-interaction js-interaction">\n  <div class="js-startprompt startprompt">\n    <h3>Measure Distances and Areas</h3>\n    <ul class="tasks">\n      <a href="#" class="js-start start">Create a new measurement</a>\n    </ul>\n  </div>\n  <div class="js-measuringprompt">\n    <h3>Measure Distances and Areas</h3>\n    <p class="js-starthelp">Start creating a measurement by adding points to the map</h3>\n    <div class="js-results results"></div>\n    <ul class="js-measuretasks tasks">\n      <li><a href="#" class="js-cancel cancel">Cancel</a></li>\n      <li><a href="#" class="js-finish finish">Finish Measurement</a></li>\n    </ul>\n  </div>\n</div>');var s=h.template('<div class="group">\n<p class="lastpoint heading">Last Point</p>\n<p><%= model.lastCoord.dms.y %> <span class="coorddivider">/</span> <%= model.lastCoord.dms.x %></p>\n<p><%= humanize.numberFormat(model.lastCoord.dd.y, 6) %> <span class="coorddivider">/</span> <%= humanize.numberFormat(model.lastCoord.dd.x, 6) %></p>\n</div>\n<% if (model.pointCount > 1) { %>\n<div class="group">\n<p><span class="heading">Path Distance</span> <%= model.lengthDisplay %></p>\n</div>\n<% } %>\n<% if (model.pointCount > 2) { %>\n<div class="group">\n<p><span class="heading">Area</span> <%= model.areaDisplay %></p>\n</div>\n<% } %>');var q=h.template('<h3>Point Location</h3>\n<p><%= model.lastCoord.dms.y %> <span class="coorddivider">/</span> <%= model.lastCoord.dms.x %></p>\n<p><%= humanize.numberFormat(model.lastCoord.dd.y, 6) %> <span class="coorddivider">/</span> <%= humanize.numberFormat(model.lastCoord.dd.x, 6) %></p>\n<ul class="tasks">\n  <li><a href="#" class="js-zoomto zoomto">Center on this Location</a></li>\n  <li><a href="#" class="js-deletemarkup deletemarkup">Delete</a></li>\n</ul>');var p=h.template('<h3>Linear Measurement</h3>\n<p><%= model.lengthDisplay %></p>\n<ul class="tasks">\n  <li><a href="#" class="js-zoomto zoomto">Center on this Line</a></li>\n  <li><a href="#" class="js-deletemarkup deletemarkup">Delete</a></li>\n</ul>');var i=h.template('<h3>Area Measurement</h3>\n<p><%= model.areaDisplay %></p>\n<p><%= model.lengthDisplay %> Perimeter</p>\n<ul class="tasks">\n  <li><a href="#" class="js-zoomto zoomto">Center on this Area</a></li>\n  <li><a href="#" class="js-deletemarkup deletemarkup">Delete</a></li>\n</ul>');o.Control.Measure=o.Control.extend({_className:"leaflet-control-measure",options:{position:"topright",primaryLengthUnit:"feet",secondaryLengthUnit:"miles",primaryAreaUnit:"acres",activeColor:"#ABE67E",completedColor:"#C8F2BE",popupOptions:{className:"leaflet-measure-resultpopup",autoPanPadding:[10,10]}},initialize:function(v){o.setOptions(this,v);this._symbols=new t(h.pick(this.options,"activeColor","completedColor"))},onAdd:function(v){this._map=v;this._latlngs=[];this._initLayout();v.on("click",this._collapse,this);this._layer=o.layerGroup().addTo(v);return this._container},onRemove:function(v){v.off("click",this._collapse,this);v.removeLayer(this._layer)},_initLayout:function(){var z=this._className,A=this._container=o.DomUtil.create("div",z);var y,x,v,w;A.innerHTML=k({model:{className:z}});A.setAttribute("aria-haspopup",true);if(!o.Browser.touch){o.DomEvent.disableClickPropagation(A);o.DomEvent.disableScrollPropagation(A)}else{o.DomEvent.on(A,"click",o.DomEvent.stopPropagation)}y=this.$toggle=f(".js-toggle",A);this.$interaction=f(".js-interaction",A);x=f(".js-start",A);v=f(".js-cancel",A);w=f(".js-finish",A);this.$startPrompt=f(".js-startprompt",A);this.$measuringPrompt=f(".js-measuringprompt",A);this.$startHelp=f(".js-starthelp",A);this.$results=f(".js-results",A);this.$measureTasks=f(".js-measuretasks",A);this._collapse();this._updateMeasureNotStarted();if(!o.Browser.android){o.DomEvent.on(A,"mouseenter",this._expand,this);o.DomEvent.on(A,"mouseleave",this._collapse,this)}o.DomEvent.on(y,"click",o.DomEvent.stop);if(o.Browser.touch){o.DomEvent.on(y,"click",this._expand,this)}else{o.DomEvent.on(y,"focus",this._expand,this)}o.DomEvent.on(x,"click",o.DomEvent.stop);o.DomEvent.on(x,"click",this._startMeasure,this);o.DomEvent.on(v,"click",o.DomEvent.stop);o.DomEvent.on(v,"click",this._finishMeasure,this);o.DomEvent.on(w,"click",o.DomEvent.stop);o.DomEvent.on(w,"click",this._handleMeasureDoubleClick,this)},_expand:function(){l.hide(this.$toggle);l.show(this.$interaction)},_collapse:function(){if(!this._locked){l.hide(this.$interaction);l.show(this.$toggle)}},_updateMeasureNotStarted:function(){l.hide(this.$startHelp);l.hide(this.$results);l.hide(this.$measureTasks);l.hide(this.$measuringPrompt);l.show(this.$startPrompt)},_updateMeasureStartedNoPoints:function(){l.hide(this.$results);l.show(this.$startHelp);l.show(this.$measureTasks);l.hide(this.$startPrompt);l.show(this.$measuringPrompt)},_updateMeasureStartedWithPoints:function(){l.hide(this.$startHelp);l.show(this.$results);l.show(this.$measureTasks);l.hide(this.$startPrompt);l.show(this.$measuringPrompt)},_startMeasure:function(){this._locked=true;this._map.doubleClickZoom.disable();this._map.on("mouseout",this._handleMapMouseOut,this);o.DomEvent.on(this._container,"mouseenter",this._handleMapMouseOut,this);if(!this._measureCollector){this._measureCollector=o.polygon([[90,-180],[90,180],[-90,180],[-90,-180]],this._symbols.getSymbol("measureCollector")).addTo(this._layer);this._measureCollector.on("mousemove",this._handleMeasureMove,this);this._measureCollector.on("dblclick",this._handleMeasureDoubleClick,this);this._measureCollector.on("click",this._handleMeasureClick,this)}this._measureCollector.bringToFront();this._measureVertexes=o.featureGroup().addTo(this._layer);this._updateMeasureStartedNoPoints()},_finishMeasure:function(){this._locked=false;this._map.doubleClickZoom.enable();this._map.off("mouseout",this._handleMapMouseOut,this);o.DomEvent.off(this._container,"mouseover",this._handleMapMouseOut,this);this._clearMeasure();this._measureCollector.off();this._layer.removeLayer(this._measureCollector);this._measureCollector=null;this._layer.removeLayer(this._measureVertexes);this._measureVertexes=null;this._updateMeasureNotStarted();this._collapse()},_clearMeasure:function(){this._latlngs=[];this._measureVertexes.clearLayers();if(this._measureDrag){this._layer.removeLayer(this._measureDrag)}if(this._measureArea){this._layer.removeLayer(this._measureArea)}if(this._measureBoundary){this._layer.removeLayer(this._measureBoundary)}this._measureDrag=null;this._measureArea=null;this._measureBoundary=null},_getMeasurementDisplayStrings:function(v){var w={};if(this.options.primaryLengthUnit&&u[this.options.primaryLengthUnit]){w.lengthDisplay=n.numberFormat(v.length[this.options.primaryLengthUnit],u[this.options.primaryLengthUnit].decimals)+" "+u[this.options.primaryLengthUnit].display;if(this.options.secondaryLengthUnit&&u[this.options.secondaryLengthUnit]){w.lengthDisplay=w.lengthDisplay+" ("+n.numberFormat(v.length[this.options.secondaryLengthUnit],u[this.options.secondaryLengthUnit].decimals)+" "+u[this.options.secondaryLengthUnit].display+")"}}if(this.options.primaryAreaUnit&&u[this.options.primaryAreaUnit]){w.areaDisplay=n.numberFormat(v.area[this.options.primaryAreaUnit],u[this.options.primaryAreaUnit].decimals)+" "+u[this.options.primaryAreaUnit].display;if(this.options.secondaryAreaUnit&&u[this.options.secondaryAreaUnit]){w.areaDisplay=w.areaDisplay+" ("+n.numberFormat(v.area[this.options.secondaryAreaUnit],u[this.options.secondaryAreaUnit].decimals)+" "+u[this.options.secondaryAreaUnit].display+")"}}return w},_updateResults:function(){var v=j.measure(this._latlngs);this.$results.innerHTML=s({model:h.extend({},v,this._getMeasurementDisplayStrings(v),{pointCount:this._latlngs.length}),humanize:n})},_handleMeasureMove:function(v){if(!this._measureDrag){this._measureDrag=o.circleMarker(v.latlng,this._symbols.getSymbol("measureDrag")).addTo(this._layer)}else{this._measureDrag.setLatLng(v.latlng)}this._measureDrag.bringToFront()},_handleMeasureDoubleClick:function(){var x=this._latlngs,v,A,y,z,B,w;this._finishMeasure();if(!x.length){return}if(x.length>2){x.push(h.first(x))}v=j.measure(x);if(x.length===1){A=o.circleMarker(x[0],this._symbols.getSymbol("resultPoint"));z=q({model:v,humanize:n})}else{if(x.length===2){A=o.polyline(x,this._symbols.getSymbol("resultLine")).addTo(this._map);z=p({model:h.extend({},v,this._getMeasurementDisplayStrings(v)),humanize:n})}else{A=o.polygon(x,this._symbols.getSymbol("resultArea"));z=i({model:h.extend({},v,this._getMeasurementDisplayStrings(v)),humanize:n,units:this._units})}}y=o.DomUtil.create("div","");y.innerHTML=z;B=f(".js-zoomto",y);if(B){o.DomEvent.on(B,"click",o.DomEvent.stop);o.DomEvent.on(B,"click",function(){this._map.fitBounds(A.getBounds(),{padding:[20,20],maxZoom:17})},this)}w=f(".js-deletemarkup",y);if(w){o.DomEvent.on(w,"click",o.DomEvent.stop);o.DomEvent.on(w,"click",function(){this._map.removeLayer(A)},this)}A.addTo(this._map);A.bindPopup(y,this.options.popupOptions);A.openPopup(A.getBounds().getCenter())},_handleMeasureClick:function(v){var x=v.latlng,w=h.last(this._latlngs),y=this._symbols.getSymbol("measureVertex");this._map.closePopup();if(!w||!x.equals(w)){this._latlngs.push(x);this._addMeasureArea(this._latlngs);this._addMeasureBoundary(this._latlngs);this._measureVertexes.eachLayer(function(z){z.setStyle(y);z._path.setAttribute("class",y.className)});this._addNewVertex(x);if(this._measureBoundary){this._measureBoundary.bringToFront()}this._measureVertexes.bringToFront()}this._updateResults();this._updateMeasureStartedWithPoints()},_handleMapMouseOut:function(){if(this._measureDrag){this._layer.removeLayer(this._measureDrag);this._measureDrag=null}},_addNewVertex:function(v){o.circleMarker(v,this._symbols.getSymbol("measureVertexActive")).addTo(this._measureVertexes)},_addMeasureArea:function(v){if(v.length<3){if(this._measureArea){this._layer.removeLayer(this._measureArea);this._measureArea=null}return}if(!this._measureArea){this._measureArea=o.polygon(v,this._symbols.getSymbol("measureArea")).addTo(this._layer)}else{this._measureArea.setLatLngs(v)}},_addMeasureBoundary:function(v){if(v.length<2){if(this._measureBoundary){this._layer.removeLayer(this._measureBoundary);this._measureBoundary=null}return}if(!this._measureBoundary){this._measureBoundary=o.polyline(v,this._symbols.getSymbol("measureBoundary")).addTo(this._layer)}else{this._measureBoundary.setLatLngs(v)}}});o.Map.mergeOptions({measureControl:false});o.Map.addInitHook(function(){if(this.options.measureControl){this.measureControl=(new o.Control.Measure()).addTo(this)}});o.control.measure=function(v){return new o.Control.Measure(v)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./calc":17,"./dom":18,"./mapsymbology":20,"./units":21,humanize:15,underscore:16}],20:[function(h,f,d){var a=h("underscore");var c=h("color");var i=function(j){this.setOptions(j)};i.DEFAULTS={activeColor:"#ABE67E",completedColor:"#C8F2BE"};a.extend(i.prototype,{setOptions:function(j){this._options=a.extend({},i.DEFAULTS,this._options,j);return this},getSymbol:function(j){var k={measureCollector:{clickable:true,stroke:false,fillOpacity:0,className:"layer-measurecollector"},measureDrag:{clickable:false,radius:4,color:this._options.activeColor,weight:2,opacity:0.7,fillColor:this._options.activeColor,fillOpacity:0.5,className:"layer-measuredrag"},measureArea:{clickable:false,stroke:false,fillColor:this._options.activeColor,fillOpacity:0.2,className:"layer-measurearea"},measureBoundary:{clickable:false,color:this._options.activeColor,weight:2,opacity:0.9,fill:false,className:"layer-measureboundary"},measureVertex:{clickable:false,radius:4,color:this._options.activeColor,weight:2,opacity:1,fillColor:this._options.activeColor,fillOpacity:0.7,className:"layer-measurevertex"},measureVertexActive:{clickable:false,radius:4,color:this._options.activeColor,weight:2,opacity:1,fillColor:c(this._options.activeColor).darken(0.15),fillOpacity:0.7,className:"layer-measurevertex active"},resultArea:{clickable:true,color:this._options.completedColor,weight:2,opacity:0.9,fillColor:this._options.completedColor,fillOpacity:0.2,className:"layer-measure-resultarea"},resultLine:{clickable:true,color:this._options.completedColor,weight:3,opacity:0.9,fill:false,className:"layer-measure-resultline"},resultPoint:{clickable:true,radius:4,color:this._options.completedColor,weight:2,opacity:1,fillColor:this._options.completedColor,fillOpacity:0.7,className:"layer-measure-resultpoint"}};return k[j]}});f.exports=i},{color:1,underscore:16}],21:[function(d,c,a){c.exports={acres:{display:"Acres",decimals:2},feet:{display:"Feet",decimals:0},kilometers:{display:"Kilometers",decimals:2},hectares:{display:"Hectares",decimals:2},meters:{display:"Meters",decimals:0},miles:{display:"Miles",decimals:2},sqmeters:{display:"Sq Meters",decimals:0},sqmiles:{display:"Sq Miles",decimals:2}}},{}]},{},[19]);